<thinking type="analysis" domain="command-execution" method="systematic">

# 命令行执行思维框架

## 核心思考维度

```mermaid
mindmap
  root((命令行执行))
    命令分析
      目的理解
      语法结构
      预期输出
    环境评估
      平台差异
      上下文状态
      必要依赖
    风险考量
      数据安全
      权限需求
      可逆性
    优化思考
      效率提升
      可读性
      组合优化
    结果解读
      成功标志
      异常分析
      后续行动
```

## 命令分析思考

### 目的理解
- 这个命令要完成什么任务？
- 这个命令在当前任务流程中的作用是什么？
- 有没有更符合意图的替代命令？

### 语法结构
- 命令的基本结构是否正确？
- 参数使用是否恰当？
- 是否存在语法优化空间？

### 预期输出
- 预期得到什么样的输出？
- 如何判断命令执行是否达到预期？

## 环境评估思考

```mermaid
flowchart TD
    A[环境分析] --> B{平台类型?}
    B -->|Windows| C[考虑CMD/PowerShell语法]
    B -->|Unix/Linux| D[考虑Bash/Zsh语法]
    B -->|macOS| E[考虑macOS特性]
    C & D & E --> F{工作目录正确?}
    F -->|否| G[调整工作目录]
    F -->|是| H{依赖检查}
    H -->|缺失| I[安装/加载依赖]
    H -->|完整| J[环境就绪]
    
    style A fill:#4da6ff,stroke:#0066cc,color:white
    style B fill:#ffa64d,stroke:#cc7a30,color:white
    style F fill:#4dbb5f,stroke:#36873f,color:white
    style H fill:#d94dbb,stroke:#a3378a,color:white
```

### 上下文状态
- 当前工作目录是否正确？
- 是否已经满足命令执行的前提条件？
- 是否需要先设置环境变量？

## 风险考量思考

### 安全评估表
| 风险类型 | 问题思考 | 缓解措施 |
|---------|---------|---------|
| 数据安全 | 命令是否会修改或删除重要数据？ | 检查命令范围，提前备份 |
| 权限控制 | 命令是否需要特定权限？ | 验证权限是否最小化 |
| 中断风险 | 命令是否可能造成系统中断？ | 评估执行时间点，准备回滚方案 |
| 可逆性 | 操作是否可逆？ | 设计回滚策略 |

## 优化思考

### 效率提升
- 能否通过管道组合多个命令？
- 是否可以使用通配符简化操作？
- 是否可以通过别名或函数封装常用操作？

### 命令优化示例
```
# 优化前
find . -name "*.txt" | xargs grep "pattern"

# 优化后
grep -r "pattern" --include="*.txt" .
```

## 结果解读思考

```mermaid
stateDiagram-v2
    [*] --> 执行命令
    执行命令 --> 成功: 返回码为0
    执行命令 --> 失败: 返回码非0
    
    成功 --> 结果分析: 验证输出
    失败 --> 错误分析: 诊断问题
    
    结果分析 --> 后续行动
    错误分析 --> 修正策略
    
    修正策略 --> 执行命令: 重试
    后续行动 --> [*]
```

### 异常分析思考
- 错误信息揭示了什么问题？
- 是命令本身错误还是环境问题？
- 有没有常见的解决方案？

### 后续行动
- 基于执行结果，下一步应该做什么？
- 是否需要保存或处理输出？
- 是否需要通知用户特定信息？

## 决策模型

处理命令行任务的决策模型:

1. **理解** - 深入理解命令目的和上下文
2. **评估** - 全面评估环境条件和执行风险
3. **优化** - 思考如何使命令更高效和安全
4. **执行** - 在适当条件下执行命令
5. **分析** - 解读结果并决定后续行动

</thinking>
